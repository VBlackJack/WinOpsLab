<mxfile host="app.diagrams.net" modified="2026-02-20T00:00:00.000Z" agent="WinOpsLab" version="24.0.0" type="device">
  <diagram id="pki" name="PKI Hierarchy">
    <mxGraphModel dx="1422" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0"/>
        <mxCell id="1" parent="0"/>

        <!-- Title -->
        <mxCell id="title" value="PKI - Certificate Authority Hierarchy" style="text;html=1;fontSize=20;fontStyle=1;align=center;verticalAlign=middle;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="284" y="10" width="600" height="40" as="geometry"/>
        </mxCell>

        <!-- Root CA section -->
        <mxCell id="rootca-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FCE4EC;strokeColor=#C62828;strokeWidth=2;arcSize=8;dashed=1;dashPattern=8 4;" vertex="1" parent="1">
          <mxGeometry x="364" y="70" width="440" height="140" as="geometry"/>
        </mxCell>
        <mxCell id="rootca-tier" value="Tier 0 - Offline" style="text;html=1;fontSize=11;fontStyle=3;align=right;fillColor=#C62828;fontColor=#FFFFFF;rounded=1;spacingRight=6;" vertex="1" parent="1">
          <mxGeometry x="674" y="75" width="120" height="22" as="geometry"/>
        </mxCell>

        <mxCell id="rootca" value="Root CA&#xa;(Standalone, Offline)&#xa;&#xa;CA-ROOT-01&#xa;Validity: 20 years&#xa;Key: RSA 4096-bit" style="shape=mxgraph.cisco.servers.standard_server;whiteSpace=wrap;html=1;fillColor=#C62828;strokeColor=#8E0000;fontSize=10;fontStyle=1;fontColor=#FFFFFF;verticalAlign=middle;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="484" y="85" width="200" height="110" as="geometry"/>
        </mxCell>

        <!-- Root cert icon -->
        <mxCell id="root-cert" value="Root&#xa;Certificate" style="shape=mxgraph.signs.safety.fire_extinguisher;whiteSpace=wrap;html=1;fillColor=#EF5350;strokeColor=#C62828;fontColor=#FFFFFF;fontSize=9;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="384" y="110" width="60" height="60" as="geometry"/>
        </mxCell>

        <!-- Issuing CA section -->
        <mxCell id="issueca-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#2E7D32;strokeWidth=2;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="264" y="270" width="640" height="160" as="geometry"/>
        </mxCell>
        <mxCell id="issueca-tier" value="Tier 1 - Online" style="text;html=1;fontSize=11;fontStyle=3;align=right;fillColor=#2E7D32;fontColor=#FFFFFF;rounded=1;spacingRight=6;" vertex="1" parent="1">
          <mxGeometry x="774" y="275" width="120" height="22" as="geometry"/>
        </mxCell>

        <mxCell id="issueca" value="Subordinate / Issuing CA&#xa;(Enterprise, Online)&#xa;&#xa;CA-ISSUING-01&#xa;Validity: 10 years&#xa;Key: RSA 2048-bit" style="shape=mxgraph.cisco.servers.standard_server;whiteSpace=wrap;html=1;fillColor=#2E7D32;strokeColor=#1B5E20;fontSize=10;fontStyle=1;fontColor=#FFFFFF;verticalAlign=middle;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="384" y="290" width="200" height="120" as="geometry"/>
        </mxCell>

        <!-- Chain from Root to Issuing -->
        <mxCell id="e-root-issue" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#C62828;strokeWidth=3;endArrow=block;endFill=1;" edge="1" source="rootca" target="issueca" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="chain-label" value="Signs subordinate&#xa;CA certificate" style="edgeLabel;html=1;fontSize=9;fontStyle=2;fillColor=#FFFFFF;" vertex="1" connectable="0" parent="e-root-issue">
          <mxGeometry relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- CRL Distribution Point -->
        <mxCell id="crl-dp" value="CRL Distribution Point&#xa;(CDP)&#xa;&#xa;http://pki.lab.local/crl&#xa;ldap://DC-01/..." style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;fontSize=10;fontStyle=1;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="654" y="300" width="200" height="90" as="geometry"/>
        </mxCell>
        <mxCell id="e-issue-crl" style="rounded=1;strokeColor=#9673A6;strokeWidth=2;dashed=1;endArrow=classic;" edge="1" source="issueca" target="crl-dp" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="crl-arrow-label" value="Publishes CRL" style="edgeLabel;html=1;fontSize=9;fontStyle=2;" vertex="1" connectable="0" parent="e-issue-crl">
          <mxGeometry relative="1" as="geometry"><mxPoint as="offset"/></mxGeometry>
        </mxCell>

        <!-- OCSP Responder -->
        <mxCell id="ocsp" value="OCSP Responder&#xa;&#xa;http://ocsp.lab.local" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;fontSize=10;fontStyle=1;shadow=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="284" y="300" width="170" height="70" as="geometry"/>
        </mxCell>

        <!-- Enrollment flow -->
        <mxCell id="enrollment-label" value="Certificate Enrollment" style="text;html=1;fontSize=14;fontStyle=1;align=center;fillColor=#2E7D32;fontColor=#FFFFFF;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="404" y="460" width="200" height="25" as="geometry"/>
        </mxCell>

        <!-- Enrollment methods -->
        <mxCell id="enroll-auto" value="Auto-Enrollment&#xa;(GPO)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;fontSize=10;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="164" y="500" width="130" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="enroll-web" value="Web Enrollment&#xa;(certsrv)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;fontSize=10;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="324" y="500" width="130" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="enroll-mmc" value="MMC Console&#xa;(certmgr.msc)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;fontSize=10;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="484" y="500" width="130" height="50" as="geometry"/>
        </mxCell>
        <mxCell id="enroll-ps" value="PowerShell&#xa;(Get-Certificate)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF2CC;strokeColor=#D6B656;fontSize=10;fontStyle=1;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="644" y="500" width="130" height="50" as="geometry"/>
        </mxCell>

        <!-- Enrollment arrows -->
        <mxCell id="e-enroll-auto" style="rounded=1;strokeColor=#D6B656;strokeWidth=1;endArrow=classic;" edge="1" source="issueca" target="enroll-auto" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-enroll-web" style="rounded=1;strokeColor=#D6B656;strokeWidth=1;endArrow=classic;" edge="1" source="issueca" target="enroll-web" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-enroll-mmc" style="rounded=1;strokeColor=#D6B656;strokeWidth=1;endArrow=classic;" edge="1" source="issueca" target="enroll-mmc" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-enroll-ps" style="rounded=1;strokeColor=#D6B656;strokeWidth=1;endArrow=classic;" edge="1" source="issueca" target="enroll-ps" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Certificate Types section -->
        <mxCell id="certs-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1565C0;strokeWidth=2;arcSize=6;" vertex="1" parent="1">
          <mxGeometry x="114" y="590" width="940" height="150" as="geometry"/>
        </mxCell>
        <mxCell id="certs-label" value="Issued Certificate Types (Templates)" style="text;html=1;fontSize=14;fontStyle=1;align=center;fillColor=#1565C0;fontColor=#FFFFFF;rounded=1;" vertex="1" parent="1">
          <mxGeometry x="334" y="595" width="300" height="25" as="geometry"/>
        </mxCell>

        <!-- Web Server cert -->
        <mxCell id="cert-web" value="Web Server&#xa;(SSL/TLS)&#xa;&#xa;IIS, HTTPS&#xa;Validity: 1-2 yr" style="shape=note;whiteSpace=wrap;html=1;fillColor=#42A5F5;strokeColor=#1565C0;fontSize=10;fontStyle=1;fontColor=#FFFFFF;size=14;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="144" y="630" width="150" height="90" as="geometry"/>
        </mxCell>

        <!-- User cert -->
        <mxCell id="cert-user" value="User Certificate&#xa;&#xa;S/MIME, EFS,&#xa;Client Auth&#xa;Validity: 1 yr" style="shape=note;whiteSpace=wrap;html=1;fillColor=#66BB6A;strokeColor=#2E7D32;fontSize=10;fontStyle=1;fontColor=#FFFFFF;size=14;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="334" y="630" width="150" height="90" as="geometry"/>
        </mxCell>

        <!-- Computer cert -->
        <mxCell id="cert-computer" value="Computer Certificate&#xa;&#xa;802.1X, IPsec,&#xa;SCCM&#xa;Validity: 1 yr" style="shape=note;whiteSpace=wrap;html=1;fillColor=#FFA726;strokeColor=#E65100;fontSize=10;fontStyle=1;fontColor=#FFFFFF;size=14;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="524" y="630" width="150" height="90" as="geometry"/>
        </mxCell>

        <!-- Code Signing cert -->
        <mxCell id="cert-code" value="Code Signing&#xa;&#xa;Scripts, Drivers,&#xa;Applications&#xa;Validity: 1-3 yr" style="shape=note;whiteSpace=wrap;html=1;fillColor=#AB47BC;strokeColor=#6A1B9A;fontSize=10;fontStyle=1;fontColor=#FFFFFF;size=14;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="714" y="630" width="150" height="90" as="geometry"/>
        </mxCell>

        <!-- Domain Controller cert -->
        <mxCell id="cert-dc" value="Domain&#xa;Controller&#xa;&#xa;LDAPS, KDC" style="shape=note;whiteSpace=wrap;html=1;fillColor=#EF5350;strokeColor=#C62828;fontSize=10;fontStyle=1;fontColor=#FFFFFF;size=14;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="894" y="630" width="130" height="90" as="geometry"/>
        </mxCell>

        <!-- Arrows from enrollment to certs -->
        <mxCell id="e-tocert1" style="rounded=1;strokeColor=#1565C0;strokeWidth=1;dashed=1;" edge="1" source="enroll-auto" target="cert-web" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-tocert2" style="rounded=1;strokeColor=#1565C0;strokeWidth=1;dashed=1;" edge="1" source="enroll-web" target="cert-user" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-tocert3" style="rounded=1;strokeColor=#1565C0;strokeWidth=1;dashed=1;" edge="1" source="enroll-mmc" target="cert-computer" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>
        <mxCell id="e-tocert4" style="rounded=1;strokeColor=#1565C0;strokeWidth=1;dashed=1;" edge="1" source="enroll-ps" target="cert-code" parent="1">
          <mxGeometry relative="1" as="geometry"/>
        </mxCell>

        <!-- Validation flow note -->
        <mxCell id="validation-note" value="Certificate Validation Flow:&#xa;1. Check certificate chain (Root &gt; Issuing &gt; End Entity)&#xa;2. Verify CRL / OCSP for revocation status&#xa;3. Validate certificate purpose (EKU)&#xa;4. Check validity period" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#999999;fontSize=10;align=left;spacingLeft=10;spacingTop=4;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="114" y="760" width="400" height="65" as="geometry"/>
        </mxCell>

        <!-- Key Storage note -->
        <mxCell id="key-note" value="Key Storage:&#xa;- Root CA: HSM or removable media (air-gapped)&#xa;- Issuing CA: TPM or software-based&#xa;- End entities: local certificate store" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#999999;fontSize=10;align=left;spacingLeft=10;spacingTop=4;shadow=1;" vertex="1" parent="1">
          <mxGeometry x="544" y="760" width="380" height="65" as="geometry"/>
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
